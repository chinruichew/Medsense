files:
  /etc/nginx/conf.d/https.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      # HTTPS server

      server {
          listen       443;
          server_name  localhost;
          
          ssl                  on;
          ssl_certificate      /etc/pki/tls/certs/server.crt;
          ssl_certificate_key  /etc/pki/tls/certs/server.key;
          
          ssl_session_timeout  5m;
          
          ssl_protocols  TLSv1 TLSv1.1 TLSv1.2;
          ssl_prefer_server_ciphers   on;
          
          location / {
              proxy_pass  http://nodejs;
              proxy_set_header   Connection "";
              proxy_http_version 1.1;
              proxy_set_header        Host            $host;
              proxy_set_header        X-Real-IP       $remote_addr;
              proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
              proxy_set_header        X-Forwarded-Proto https;
          }
      }
  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN CERTIFICATE-----
      MIIDkjCCAnoCCQC2wkyMSno/jzANBgkqhkiG9w0BAQsFADCBhzELMAkGA1UEBhMCU0cxCzAJBgNVBAgMAlNHMQswCQYDVQQHDAJTRzERMA8GA1UECgwITWVkc2Vuc2UxCzAJBgNVBAsMAkNBMRgwFgYDVQQDDA90aGVtZWRzZW5zZS5jb20xJDAiBgkqhkiG9w0BCQEWFWNoZXdjaGlucnVpQGdtYWlsLmNvbTAgFw0xODAzMjIwODI2NDJaGA8yMTE2MTAxNDA4MjY0MlowgYsxCzAJBgNVBAYTAlNHMQswCQYDVQQIDAJTRzELMAkGA1UEBwwCU0cxETAPBgNVBAoMCE1lZHNlbnNlMQ8wDQYDVQQLDAZTZXJ2ZXIxGDAWBgNVBAMMD3RoZW1lZHNlbnNlLmNvbTEkMCIGCSqGSIb3DQEJARYVY2hld2NoaW5ydWlAZ21haWwuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7EsHYKSzZm5hyzq7fhSu8nSo53vBeOeZfNAZ+ePK0luWeTdIs24SnH874nrrM/myUnz5AUbEt6DGzQQ17+WX+N4LOciaHn1hLQBEhGP92gzd/QxBd7ayTeUrY646bexcKuDCl6Orwuf9v4oGHBut4ilurAIqbpVpkLr+L3+kOBNOZsU1iZ1+1QMmUwKtVAqzXj3cOAv0ljI04rK25V++Pq0Iqw6pdBeaf+ZLD3iKafpQUKJcXdkX+oDGQSKeQ2UoH0CMx0VCqoXnNVRk0LzMmIxYlhLefDaG7EnDujB/h2wuY5XVsftr+gwweBdtpOVAN+hG5EFVJsUZZWVJQAsXpQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQCnLJa/vSzUfs3pQvIDCIgMz8auvQFmLLv21tgqZHMM1xM9Mb7g39CMRSpyFv1KPrnwpJWx2Rl3BV6XpBqzAKYOqHpmyCac8YkExnSSYbTmLlSBVM5oDl47u43XEsO0MLDmstIbBQWvsmltEIoqTWqqkdViAyFXCWwbxplx07XZwcFTlHeDBYot4ZVclulhISmcL20x4hbJtSySCiDtUz6rjHNPVW43vyvsfavI5ZrjHjqcGPN7kpGYTPtfDgGoHISN6I+fOa9kT1tCiJukUGdGdul67khtiOhdihrH2gKIK1aEit9ltFHaY6gzj/t1AJ7OLiMv8mg1Xts+bCjEuYci
      -----END CERTIFICATE-----
      
  /etc/pki/tls/certs/server.key:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEogIBAAKCAQEA7EsHYKSzZm5hyzq7fhSu8nSo53vBeOeZfNAZ+ePK0luWeTdIs24SnH874nrrM/myUnz5AUbEt6DGzQQ17+WX+N4LOciaHn1hLQBEhGP92gzd/QxBd7ayTeUrY646bexcKuDCl6Orwuf9v4oGHBut4ilurAIqbpVpkLr+L3+kOBNOZsU1iZ1+1QMmUwKtVAqzXj3cOAv0ljI04rK25V++Pq0Iqw6pdBeaf+ZLD3iKafpQUKJcXdkX+oDGQSKeQ2UoH0CMx0VCqoXnNVRk0LzMmIxYlhLefDaG7EnDujB/h2wuY5XVsftr+gwweBdtpOVAN+hG5EFVJsUZZWVJQAsXpQIDAQABAoIBAELAh1sD7DJZqILTGrhpe2q/DiAm0+cl9jROTahMc7WtbfrcZUtbIyLWxsIaW2uZdIjdCTMVHOmLH942/E3DHIWPpLg0NWW7ocImuzRzUvlQfT3JQo1hLUnYHcPRKmx3QypRyGcyM4miJAsCIOu73glwDvXEvtvylZnvWXNtqaS1NI9ej2nmqPcwjf5Ccskpo8er9qIcY0Bc/w71tAA6xQdJ3Lsq0Xe6Vi9uvrlX4mVVTxCtnXJLS466sT4YYSoSCNYQ5Jpn4lh9W6Fd2KWKQfT90T/xb+Ltsp6WUdTwCr9klu7oqX0v3fS3QXu8hGN3Cdbubok3ipJZpsiNTOYkL0ECgYEA9/g+nZG/IyFFwg8YTd1G8l3M2UxW5mr+Y7x1n4b8FnNalWIhDM3pnxxkXZdesS+YgDpU2ZDdF2Spj9Sdga66kb/hLI/4v4IB8wIV0ZMrrSfTtvuS9azZ72SCoQgWrOD9G06BplU4jxutNPs+TH860p1EG4uMpiu4ajTU6UCJvrkCgYEA8/H7HrIfTqaxguxTqvBpeczeb+EhBz6j6OC0PgfuDNDzifml8x40NJwMcrVgH3RLkqqF14k/ZiIaIzFmO0VyUzm15fbNH8oiRpLaqIsLARX2IdBxzs86qnE57LI9qvIbP50JAcoW3LHUgyXt5X7/nUgBUWBrn2KH0LRWciW1ik0CgYAw/5av4BrawDpejEkLKcxZG/vcfF83jLDT2GuNqEirzwN5PTi2pQGi9SNH8x889+C0hdI6Y4uskbGHwEWXWIV5Q2clPRW0EeZ8tE7HaMNapeIJ6FAzx4IQ8dV2KHkClDqvaKXpzjEs5hUlwPegeguPjo/kuYCDXWRFaEciCCSv0QKBgGQ/aOcwY9U6g3A+FhQFQBMhsbdgWOZVQ56L2QY01ArIQ4zL3vqNyv5jsmnhR2Mls3jOQrpUWI1sLjmQL2bkHxs8eBfM2Hbb5kICT4E7woXrtH4o3twSJRWt+hPfG6CIZdI6gl0N419GZQKQL7dD/V9xG7mJWjDhmNaXhX7bKENxAoGAENJseC1uS3LJvsD0T0FMukYY8fnKfsDZo9mmbVTqJiXzj2oABjdtjT039PePLbIoVG0l6XGwSUyCAGzT8W5bnbUt08k/81qE8ogF8hhEycuiJ2Z93yoDtvMo4lo1G/jfO2iEXqv+KeJVDSu+CceUuneBB4003yg5rj7shJOJuAc=
      -----END RSA PRIVATE KEY-----