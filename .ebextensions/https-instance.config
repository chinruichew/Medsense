files:
  /etc/nginx/conf.d/https.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      # HTTPS server

      server {
          listen       443;
          server_name  localhost;
          
          ssl                  on;
          ssl_certificate      /etc/pki/tls/certs/server.crt;
          ssl_certificate_key  /etc/pki/tls/certs/server.key;
          
          ssl_session_timeout  5m;
          
          ssl_protocols  TLSv1 TLSv1.1 TLSv1.2;
          ssl_prefer_server_ciphers   on;
          
          location / {
              proxy_pass  http://nodejs;
              proxy_set_header   Connection "";
              proxy_http_version 1.1;
              proxy_set_header        Host            $host;
              proxy_set_header        X-Real-IP       $remote_addr;
              proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
              proxy_set_header        X-Forwarded-Proto https;
          }
      }
  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN CERTIFICATE-----
      MIIFFjCCA/6gAwIBAgISA+lzh+WlSYMd6joPW3IgQjvsMA0GCSqGSIb3DQEBCwUAMEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQDExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xODAzMjIwNzU4NThaFw0xODA2MjAwNzU4NThaMBoxGDAWBgNVBAMTD3RoZW1lZHNlbnNlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALh01oOIk255wGbsuml115mX72wWH9w20y3gqgGob1Jn7cs/ethpKAImAYSC9UUmYR5BSkfqT9inNv9G+ad0lkJILrJ/8w1gs9jEVBPXvZ9geQpvtU6tR2QrJknZaz5oPDm+kH3eNUCA1z1AkztMX2if7mNmYFN2PwWAQwh2OHFoZg7qQeC9so3AwiPDSPV0dybUxTIaly+nfPdAKnglcg03P13bYwu8yRVPhaff71fiZcLrBfpqOP3yL8yq3RhYRMkU9c+qihLIJcL54A18DEcLP8CmkJlF8jyGmiwOBwFq3xkswhx1umo+euSQCcH99L7knrMs7gdGiaIK0SOpVEsCAwEAAaOCAiQwggIgMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUokB9OXTW3TPLyzRF7ZgXAs7sI24wHwYDVR0jBBgwFoAUqEpqYwR93brm0Tm3pkVl7/Oo7KEwbwYIKwYBBQUHAQEEYzBhMC4GCCsGAQUFBzABhiJodHRwOi8vb2NzcC5pbnQteDMubGV0c2VuY3J5cHQub3JnMC8GCCsGAQUFBzAChiNodHRwOi8vY2VydC5pbnQteDMubGV0c2VuY3J5cHQub3JnLzAvBgNVHREEKDAmgg90aGVtZWRzZW5zZS5jb22CE3d3dy50aGVtZWRzZW5zZS5jb20wgf4GA1UdIASB9jCB8zAIBgZngQwBAgEwgeYGCysGAQQBgt8TAQEBMIHWMCYGCCsGAQUFBwIBFhpodHRwOi8vY3BzLmxldHNlbmNyeXB0Lm9yZzCBqwYIKwYBBQUHAgIwgZ4MgZtUaGlzIENlcnRpZmljYXRlIG1heSBvbmx5IGJlIHJlbGllZCB1cG9uIGJ5IFJlbHlpbmcgUGFydGllcyBhbmQgb25seSBpbiBhY2NvcmRhbmNlIHdpdGggdGhlIENlcnRpZmljYXRlIFBvbGljeSBmb3VuZCBhdCBodHRwczovL2xldHNlbmNyeXB0Lm9yZy9yZXBvc2l0b3J5LzANBgkqhkiG9w0BAQsFAAOCAQEAKXrl+kgdoZYFWOOmN7VB0qnCG74Y/CQj7L7LnoONpNlqTeurCozRcNgcE4G1Ymvg7JsAGu5ruth5kyfLG1NBjj41Q7e8cwzIQcVokDthVdpYXgYgPvnD+Rk0Ol7W5ggTQSWyYqysnT4xkvBXfcAGDuS5CPrfek8tUasFjnhw0dsBc5YexpZP22QoxGN5Gx3zzlHRN0OuUGsjSwakP0qmQMB0lOp9KGK4OUycr+uMfnKRdpjmusDJ/0ou0FjjjIjf7Gevc2yt+ruWIBVSHx6jV248+UZ8Sgu+ZADTjZrYLiCFLnIcg1bY4jP+8YljxKgDLK1JkqOn/95pEuEol7lD+A==
      -----END CERTIFICATE-----
      
  /etc/pki/tls/certs/server.key:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEugIBADANBgkqhkiG9w0BAQEFAASCBKQwggSgAgEAAoIBAQC4dNaDiJNuecBm7LppddeZl+9sFh/cNtMt4KoBqG9SZ+3LP3rYaSgCJgGEgvVFJmEeQUpH6k/Ypzb/RvmndJZCSC6yf/MNYLPYxFQT172fYHkKb7VOrUdkKyZJ2Ws+aDw5vpB93jVAgNc9QJM7TF9on+5jZmBTdj8FgEMIdjhxaGYO6kHgvbKNwMIjw0j1dHcm1MUyGpcvp3z3QCp4JXINNz9d22MLvMkVT4Wn3+9X4mXC6wX6ajj98i/Mqt0YWETJFPXPqooSyCXC+eANfAxHCz/AppCZRfI8hposDgcBat8ZLMIcdbpqPnrkkAnB/fS+5J6zLO4HRomiCtEjqVRLAgMBAAECgf8mgxRSfpzqfVf1saWSYj69kaKh9vHNakfOoynilL2BONOiwsAW2gUBauM3o7/4+S07LD5iWKC4MvmOw9tlCADJJHce8gTZbmiAhONH2F4FIB7f5EjCJvzNJps1lykd9ZugZw1ZJL3wwhwPFV1EJhR7+DPoq3D8e5PrtO4PJioOnb1/tsA7mpicc8At/ml22WZB/gBt3BwkvLNQtgwXP+0OGMxCnxFZdLd0vWwiOlcldtNxr57QnXTi/kWgqD/7X645P+L9edp+Kfytror3xNJtUtiSjVdq3QyRqo+w9K/QqXJ2FalDiWarZXYmLBcfbzjOyHGl6IPVNxlB83/m3DECgYEA2XX7VGNJ1oFEGAAI373MLVyE6AqLamthAPkAjdsjX00Quux5OwaYBJbNQZ2ealq6TzACBle+JVXysix5azybBv7YdY218rHKz0R1yo35KU6a4nTlwDd76C2futW5lytpbiD3MHnGkh3vGua1nkG0i4XlD+kink+cjGNahbyzjXECgYEA2SV4kmoXPyYe8KTygqQm9GD3ZELp5YXkGg/gLWmI3p2dgBlnIvBw1ePm8QMv0zSAiHmcj/oRXZBkQ7z5wmcGNtPUMzYnMucYMt5jL5K8fuJO3qt7FxX7qeKNx7SK3vakXkba0RVyLYWgQGT533xvB8bqrjSOxi5O7AiZo19mz3sCgYAsyBcRscCq48PaDWfGa5d4X+0eu80qBSLcyGpMzCvknEItvDTa6uizSTrLoGHXFQf49rH0DG2j0qc/+dinNLvYHPMGgkBN0j8pn7eCFuqQjxdmOxx1EPf7QCn8l7a4YsA7ZZ6B5RH3VSLAL3KHPJCpitE5DZGLeGmMn4kssUdogQKBgFi8DDpgqiE/FbOm5Abox5ZjrZTGF0iY3y6bQDOuhaTa6cq4FsJbWPC+0de5QqjfMosSjxzyxnfikmZv6ew8J3juNS+8OGZ/sw7Oe9+r6eU725j4oDM943p3vxJVv83/Ign4kGCSj/b0PRkzajyeX8zgx3PqvFFWCSBBH294g83TAoGAfsn6IpzbIgh9RlspWTGVQQpsvCUTboaDjvtm85wkW6aaQNDGHDM1gFDU7ozc92qP3GglSaptGp6WFDQC5BZo1gG0wL+sHH8dPsri36W48/RAB4XEN+LNOb9Nzw00FB7h3iukhx1Ga7fKBnSkfU3VvsKCIIRm6GWUbMDX7q5AGc0=
      -----END RSA PRIVATE KEY-----